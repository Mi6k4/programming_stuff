import psycopg2
from typing import List,AnyStr
gp_con = 'postgresql://zeppelin:R63v5NspNsSEem@172.21.216.13:5432/warehouse'

tables_list = (
    ('bb_supplementary_agreements_supplementaryagreement', 335),
    ('bb_registries_registry', 190),
    ('bb_slots_slot', 317),
    ('bb_patients_patient', 305),
    ('bb_medical_program_clinicinprogram', 287),
    ('bb_pricelists_pricelist', 310),
    ('bb_complaints_complaint', 192),
    ('bb_telemedicine_consultation', 343),
    ('bb_chat_conversation', 501),
    ('bb_clinics_clinic', 241),
    ('bb_vzr_policy_vzrpolicy', 170),
    ('bb_vzr_policy_vzrpurchasebill', 171),
    ('bb_complaints_complaintcategory', 191),
    ('bb_newsletters_newsletter', 194),
    ('bb_client_account_management_accountuser', 239),
    ('bb_clinics_additionalclinicmedtypeinfo', 240),
    ('bb_clinics_cliniclegalentity', 242),
    ('bb_clinics_clinicnetwork', 244),
    ('bb_clinics_clinictype', 245),
    ('bb_clinics_stationardepartment', 246),
    ('bb_clinics_cliniccontract', 249),
    ('bb_companies_company', 256),
    ('bb_company_reports_reportfiles', 259),
    ('bb_expertise_acts_expertiseact', 266),
    ('bb_franchises_medicaltypeprogrammfranchise', 271),
    ('bb_geo_city', 277),
    ('bb_geo_region', 279),
    ('bb_geo_metrostation', 280),
    ('bb_medical_program_clinicbestdoctorservicetype', 286),
    ('bb_medical_program_programbestdoctorservicetype', 290),
    ('bb_medical_services_old_medicalservice', 296),
    ('bb_patient_bank_cards_patientbankcard', 298),
    ('bb_patients_patientrelativerelation', 307),
    ('bb_programs_program', 403),
    ('bb_service_periods_personalserviceperiod', 314),
    ('bb_service_periods_companyserviceperiod', 315),
    ('bb_service_periods_bill', 316),
    ('bb_slots_scheduledslotprogramchange', 319),
    ('bb_medical_program_mkb10record', 358),
    ('bb_chat_operator', 393),
    ('bb_approvals_approvement_appeals', 427),
    ('bb_clinics_clinic_departments', 437),
    ('bb_companies_company_hr_user', 440),
    ('bb_pricelists_pricelist_clinics', 460),
    ('bb_companies_holding', 255),
    ('bb_appeals_appeal', 198),
    ('bb_visits_visit', 321),
    ('bb_sessions_session', 5),
    ('bb_bestdoctor_cliniccontract', 44),
    ('bb_bestdoctor_visit', 17),
    ('bb_bestdoctor_polyclinic', 83),
    ('bb_bestdoctor_personalserviceperiod', 108),
    ('bb_bestdoctor_clinicactionlog', 116),
    ('bb_actuarial_calculations_customservice', 234),
    ('bb_email_distributions_emaildistributionplan', 264),
    ('bb_email_distributions_emaildistributionitem', 265),
    ('bb_patient_bills_personalbillrefundlog', 303),
    ('bb_service_periods_companyadditionalservice', 313),
    ('bb_products_productcategory', 327),
    ('bb_expertise_acts_expertiseactdocument', 334),
    ('bb_clinics_clinicprovider', 336),
    ('bb_registries_registryrecordmedicalservice', 350),
    ('bb_clinics_clinic_additional_med_types', 439),
    ('bb_programs_service_info_programinfocategory', 506),
    ('bb_claims_compensation', 578),
    ('bb_slots_programoptioninslotbyinsurancerequest', 594),
    ('bb_pricelists_medicalserviceinfo_product_categories', 620),
    ('bb_staff_staffmember', 625),
    ('bb_registries_serviceinslotoptionregistryreason', 644),
    ('bb_orders_orderforprogramoption', 657),
    ('bb_webask_webaskformquestion', 659),
    ('bb_registries_serviceinorderregistryreason', 668),
    ('bb_dynamic_franchises_slotdynamicfranchise', 676),
    ('bb_sales_clinicgroupupsaleprice', 680),
    ('bb_slots_programoptioninslotbyclinicsupsale', 688),
    ('bb_supplementary_agreements_supplementaryagreementlog', 708),
    ('bb_dialogues_dialoguechunk', 723),
    ('bb_easy_thumbnails_thumbnaildimensions', 21),
    ('bb_bestdoctor_stationar', 37),
    ('bb_bestdoctor_vzrpolicy', 38),
    ('bb_bestdoctor_companyserviceperiod', 39),
    ('bb_mail_email', 138),
    ('bb_bestdoctor_patientemailverificationaction', 166),
    ('bb_gis_postgisspatialrefsys', 223),
    ('bb_leads_lead', 282),
    ('bb_patient_bills_patientbill', 300),
    ('bb_orders_orderstatus', 323),
    ('bb_references_documenttemplate', 331),
    ('bb_supplementary_agreements_payment', 339),
    ('bb_nps_nps', 419),
    ('bb_myauth_groupconfig', 425),
    ('bb_attachment_lists_patientlistforclinic_clinic_events', 434),
    ('bb_myauth_myuser_user_permissions', 452),
    ('bb_orders_order_service_tree_nodes', 469),
    ('bb_ratings_programrating', 492),
    ('bb_prepaid_programs_prepaidprogramregistry_holdings', 521),
    ('bb_service_periods_companyservicecontract', 631),
    ('bb_model_events_instancechangerecordbeacon', 704),
    ('bb_metrics_metricsetting', 714),
    ('bb_policy_change_history_personaldatajsonfixevent', 754),
    ('bb_policy_change_history_patientprogramchangefixevent', 762),
    ('bb_bestdoctor_patient', 33),
    ('bb_bestdoctor_bill', 41),
    ('bb_bestdoctor_signeddocumentlog', 119),
    ('bb_bestdoctor_vzrpurchasebill', 137),
    ('bb_bestdoctor_programnodetoclinicnodelink', 159),
    ('bb_registries_registryrecord', 189),
    ('bb_covid_bot_telegramuser', 208),
    ('bb_email_distributions_emaildistribution', 262),
    ('bb_franchises_medicalservicepersonalfranchise', 268),
    ('bb_patient_bills_patientbillgroup', 301),
    ('bb_approvals_autoapprovalwhitelist', 354),
    ('bb_products_programproductcategory', 361),
    ('bb_programs_programunprofitableclinic', 404),
    ('bb_medical_standards_medicalstandard', 422),
    ('bb_approvals_approvementservicecomplex', 424),
    ('bb_attachment_lists_employeeattachmentlist_detached_patients', 432),
    ('bb_companies_company_hr_user', 440),
    ('bb_expertise_acts_expertiseact_documents', 445),
    ('bb_pricelists_medicalserviceinfo_service_tree_node_categories', 459),
    ('bb_documents_documentattachment', 496),
    ('bb_deposits_slotdeposit', 517),
    ('bb_prepaid_programs_distancefactor', 535),
    ('bb_visits_visitclinichistory', 540),
    ('bb_appeals_appealchattopicsetting', 587),
    ('bb_slots_programoptioninslotbycommonprogram', 593),
    ('bb_quality_control_assessmentscore', 601),
    ('bb_orders_orderprogramoption', 626),
    ('bb_company_reports_reportgenerationconfig', 634),
    ('bb_adjustment_acts_accountingtypeadjustmentact', 635),
    ('bb_telemedicine_consultationtemplate_checkups_expense_patient', 661),
    ('bb_medical_program_clinicprogramservicetreenode', 671),
    ('bb_registries_technicalregistryreason', 692),
    ('bb_documents_documentlink', 693),
    ('bb_admin_logentry', 1),
    ('bb_bestdoctor_clinic', 13),
    ('bb_bestdoctor_approvement', 30),
    ('bb_bestdoctor_emaildistribution', 88),
    ('bb_bestdoctor_operator', 103),
    ('bb_bestdoctor_patientbill', 115),
    ('bb_approvals_approvement', 176),
    ('bb_newsletters_telegrampatientnewsletter', 211),
    ('bb_actuarial_calculations_commercialofferpackage', 230),
    ('bb_franchises_polyclinicprogrammfranchise', 274),
    ('bb_exports_for_clinics_exportforclinics', 345),
    ('bb_insurance_insurancerequest_service_types', 449),
    ('bb_newsletters_chatnotifications_recipients', 455),
    ('bb_patient_bills_patientbillgroup_patient_bills', 458),
    ('bb_symptomchecker_resultsettingsfactor', 485),
    ('bb_appeals_appeal_clinics', 511),
    ('bb_clinics_clinicactualizationrequest', 564),
    ('bb_sales_programoptionforproductforsale', 596),
    ('bb_quality_control_assessmentcriterion', 600),
    ('bb_promotions_programbanner', 608),
    ('bb_employees_division', 614),
    ('bb_programs_programfranchisethreshold', 663),
    ('bb_slots_dynamicfranchiseinslot', 664),
    ('bb_big_brother_instancechangerecordbeacon', 701),
    ('bb_supplementary_agreements_supplementaryagreementrequest', 710),
    ('bb_policy_change_history_programdatajsonchangeevent', 755),
    ('bb_bestdoctor_cliniclegalentity', 43),
    ('bb_bestdoctor_pricelistimportprocess', 92),
    ('bb_bestdoctor_stomatologyprogrammfranchise', 97),
    ('bb_bestdoctor_medicaltypepersonalfranchise', 101),
    ('bb_doctors_specialty', 182),
    ('bb_doctors_doctor', 183),
    ('bb_registries_clientregistry', 188),
    ('bb_patient_impressions_patientimpression', 204),
    ('bb_django_celery_beat_crontabschedule', 215),
    ('bb_bestdoctor_region', 224),
    ('bb_attachment_lists_attachmentlisttoclinic', 235),
    ('bb_clinics_polyclinic', 252),
    ('bb_expertise_acts_expertiseactrecord', 267),
    ('bb_franchises_stomatologypersonalfranchise', 275),
    ('bb_medical_program_bestdoctorservicetype', 285),
    ('bb_medical_program_programnodetoclinicnodelink', 291),
    ('bb_patient_bank_cards_cardattachmentbill', 299),
    ('bb_adjustment_acts_franchiseadjustmentact', 357),
    ('bb_doctors_doctor_specialty', 442),
    ('bb_visits_visit_program_options', 462),
    ('bb_notifications_usernotification', 476),
    ('bb_visits_homecallvisit', 633),
    ('bb_patients_patient_audiences', 647),
    ('bb_orders_orderpartnerprogramcertificate', 655),
    ('bb_promotions_audiencebutton', 674),
    ('bb_sales_clinicupsalepriceconfig', 681),
    ('bb_vzr_policy_rbiborderoslotaggregationtoslot', 746),
    ('bb_policy_change_history_patientattachmentfixevent', 760),
    ('bb_easy_thumbnails_thumbnail', 20),
    ('bb_bestdoctor_specialty', 14),
    ('bb_bestdoctor_servicetreenode', 157),
    ('bb_actuarial_calculations_commercialoffer', 229),
    ('bb_programs_programdirectattachmentpolyclinic', 410),
    ('bb_newsletters_newsletter_recipients', 453),
    ('bb_orders_ordercancellationreason_statuses', 467),
    ('bb_products_product_service_tree_nodes', 473),
    ('bb_chat_topic', 500),
    ('bb_prepaid_programs_prepaidprogram', 523),
    ('bb_prepaid_programs_prepaidprogramadvanceinvoice', 526),
    ('bb_programs_clinicwitchfranchisepgview', 538),
    ('bb_request_letters_requestletter_appeals', 571),
    ('bb_claims_claimattachment', 580),
    ('bb_quality_control_employeeassessment', 603),
    ('bb_staff_division', 622),
    ('bb_partners_productinintegration', 698),
    ('bb_dialogues_emaildialogue', 718),
    ('bb_dialogues_dialogueevent', 724),
    ('bb_auth_group', 3),
    ('bb_bestdoctor_patientregistry', 81),
    ('bb_bestdoctor_registry', 82),
    ('bb_bestdoctor_medicaltypeprogrammfranchise', 96),
    ('bb_bestdoctor_slot', 105),
    ('bb_integration_odincreportfilesnotification', 136),
    ('bb_bestdoctor_approvementservicetreenode', 174),
    ('bb_chat_patientchattodesktransport', 201),
    ('bb_newsletters_chatnotifications', 205),
    ('bb_covid_bot_covidorder', 210),
    ('bb_django_celery_beat_solarschedule', 219),
    ('bb_franchises_medicaltypepersonalfranchise', 270),
    ('bb_medical_program_programservicetreenode', 293),
    ('bb_doctors_doctorcurator', 340),
    ('bb_programs_programdirectattachmentstomatology', 409),
    ('bb_symptomchecker_resultsettingsquestion', 486),
    ('bb_programs_service_info_programinfoservice', 508),
    ('bb_clinics_programclinicprepaidprogram', 514),
    ('bb_franchises_servicetypeprogramfranchise', 530),
    ('bb_medical_program_serviceinprogramwithmedicalprogramconditionspgview', 532),
    ('bb_appeals_appeal_vzr_policies', 544),
    ('bb_services_popularspecialty', 548),
    ('bb_chat_chatkeywordcase_already_sent_to', 551),
    ('bb_appeals_appeal_clinic_actualization_requests', 565),
    ('bb_claims_claim', 579),
    ('bb_products_productinmedicalprogram', 584),
    ('bb_orders_retailmargin_clinics', 588),
    ('bb_slots_programoptioninslot', 592),
    ('bb_quality_control_assessmentcategory', 598),
    ('bb_claims_claim_complained_staff', 628),
    ('bb_telemedicine_consultationtemplate', 662),
    ('bb_dynamic_franchises_dynamicfranchiseinslot', 677),
    ('bb_partners_partnerproduct', 697),
    ('bb_vzr_policy_borderoimportrow', 737),
    ('bb_auth_permission', 2),
    ('bb_myauth_myuser', 8),
    ('bb_bestdoctor_medicalserviceinfo', 48),
    ('bb_integration_integrationmapping', 54),
    ('bb_bestdoctor_guarantletter', 24),
    ('bb_bestdoctor_patientlistforclinic', 117),
    ('bb_bestdoctor_clinicmedtypeinfo', 145),
    ('bb_bestdoctor_clinicinprogram', 184),
    ('bb_complaints_cliniccomplaint', 193),
    ('bb_django_celery_beat_periodictasks', 218),
    ('bb_attachment_lists_employeeattachmentlist', 237),
    ('bb_clinics_ambulance', 251),
    ('bb_matching_pricelistimportprocess', 284),
    ('bb_patient_create_requests_patientcreaterequest', 304),
    ('bb_content_templates_contenttemplate', 352),
    ('bb_medical_program_serviceinprogrampgview', 355),
    ('bb_programs_programprofitableclinic', 406),
    ('bb_programs_programavailablespecialty', 411),
    ('bb_myauth_myuser_groups', 451),
    ('bb_orders_order_service_types', 468),
    ('bb_telemedicine_consultation_checkups_expense_patient', 475),
    ('bb_ratings_slotrating', 493),
    ('bb_documents_documenttype', 494),
    ('bb_documents_document', 495),
    ('bb_visits_visitdocument', 498),
    ('bb_programs_service_info_programinfogroup', 507),
    ('bb_deposits_programdeposit', 519),
    ('bb_newsletters_emailtemplate', 547),
    ('bb_orders_orderitemserviceinpricelist', 562),
    ('bb_request_letters_requestletter', 572),
    ('bb_employees_functionality', 615),
    ('bb_actual_visits_actualvisit', 632),
    ('bb_promotions_groupbutton', 672),
    ('bb_registries_unknownregistryreason', 691),
    ('bb_certificates_activation_certificateactivationrequest', 715),
    ('bb_insurance_insurancerisktype', 728),
    ('bb_contenttypes_contenttype', 4),
    ('bb_bestdoctor_pricelist', 46),
    ('bb_bestdoctor_employeeattachmentlist', 31),
    ('bb_bestdoctor_cardattachmentbill', 112),
    ('bb_bestdoctor_vipdeposit', 125),
    ('bb_integration_integrationapimapping', 146),
    ('bb_exoskeleton_overriddenslotadmintype', 186),
    ('bb_bestdoctor_clinicservicetreenode', 221),
    ('bb_gis_postgisgeometrycolumns', 222),
    ('bb_attachment_lists_patientlistforclinic', 238),
    ('bb_company_action_logs_companyactionlog', 257),
    ('bb_franchises_polyclinicpersonalfranchise', 273),
    ('bb_chat_chattodesktagrelation', 328),
    ('bb_insurance_fronter', 337),
    ('bb_guarant_letters_guarantletter_appeals', 447),
    ('bb_orders_orderstatus_next_statuses', 466),
    ('bb_symptomchecker_factor', 478),
    ('bb_chat_intercompatient', 497),
    ('bb_programs_service_info_programservicecategoryinfopgview', 505),
    ('bb_geo_timezone', 528),
    ('bb_nps_splittestsettings', 549),
    ('bb_claims_claimkind', 574),
    ('bb_registries_serviceinapprovementregistryreason', 675),
    ('bb_partners_partnerintegration', 696),
    ('bb_policy_change_history_policyevent', 752),
    ('bb_policy_change_history_patientattachmentevent', 759),
    ('bb_bestdoctor_clinicanotherfile', 49),
    ('bb_bestdoctor_bdmanager', 22),
    ('bb_bestdoctor_clinicnetwork', 12),
    ('bb_bestdoctor_emaildistributionplan', 85),
    ('bb_bestdoctor_personalcardattachmentbill', 106),
    ('bb_chat_messageattachment', 110),
    ('bb_bestdoctor_customservice', 130),
    ('bb_bestdoctor_bonusservice', 131),
    ('bb_bestdoctor_slotchangelog', 132),
    ('bb_bestdoctor_totalcustomservice', 135),
    ('bb_big_brother_instancechangerecord', 149),
    ('bb_waffle_flag', 151),
    ('bb_promotions_programpromotion', 226),
    ('bb_guarant_letters_guarantletter', 281),
    ('bb_orders_order', 324),
    ('bb_appeals_appealcategory', 330),
    ('bb_chat_chatkeyword', 502),
    ('bb_approvals_approvement_concomitant_diagnoses', 539),
    ('bb_orders_orderitem', 561),
    ('bb_claims_claim_feedback', 591),
    ('bb_quality_control_assessmentsubject', 599),
    ('bb_quality_control_employeeassessment_scores', 602),
    ('bb_camunda_integration_ticket', 611),
    ('bb_registries_productinbaseprogramregistryreason', 646),
    ('bb_promotions_audiencebanner', 648),
    ('bb_programs_insuranceriskinprogram_insurance_risks', 729),
    ('bb_policy_change_history_patientdetachmentfixevent', 758),
    ('bb_bestdoctor_company', 6),
    ('bb_bestdoctor_registryrecord', 77),
    ('bb_bestdoctor_city', 90),
    ('bb_bestdoctor_medicalserviceprogrammfranchise', 100),
    ('bb_looper_loopertaskdata', 120),
    ('bb_bestdoctor_hospitalizationevent', 122),
    ('bb_bestdoctor_patientrelativerelation', 148),
    ('bb_bestdoctor_holding', 156),
    ('bb_clinics_stationar', 253),
    ('bb_medical_program_clinicservicenode', 288),
    ('bb_supplementary_agreements_paymentperiodmodel', 332),
    ('bb_adjustment_acts_reportadjustmentact', 356),
    ('bb_programs_programm', 395),
    ('bb_programs_programoption', 413),
    ('bb_telemedicine_consultationattachment', 418),
    ('bb_approvals_approvement_program_options', 426),
    ('bb_patient_bills_patientbill_considered_expertise_acts', 457),
    ('bb_myauth_groupconfig_restrict_admin_access_content_types', 477),
    ('bb_symptomchecker_result', 483),
    ('bb_ratings_cluster', 489),
    ('bb_ratings_clinicrating', 490),
    ('bb_chat_chatkeywordcase', 503),
    ('bb_nps_blacklistrule', 515),
    ('bb_prepaid_programs_agefactor', 536),
    ('bb_prepaid_programs_prepaidprogramregistryrecord', 543),
    ('bb_myauth_groupconfig_available_categories', 545),
    ('bb_partners_partnerprogramcertificate', 553),
    ('bb_claims_feedbackcategory', 575),
    ('bb_quality_control_employeeassessmentattachment', 604),
    ('bb_audiences_audience', 649),
    ('bb_registries_serviceincompanyoptionregistryreason', 652),
    ('bb_comments_commentlink', 706),
    ('bb_metrics_patientmetricset', 709),
    ('bb_big_brother_instancechangerecordexternal', 712),
    ('bb_dialogues_dialogue', 720),
    ('bb_ses_bestinsure_sesdata', 731),
    ('bb_bestdoctor_cliniclicense', 45),
    ('bb_bestdoctor_metroline', 89),
    ('bb_chat_livetexprogramroute', 161),
    ('bb_bestdoctor_programbestdoctorservicetype', 167),
    ('bb_django_dramatiq_task', 185),
    ('bb_clinics_clinicmedtypeinfo', 247),
    ('bb_currency_currency', 261),
    ('bb_email_distributions_emaildistributiontemplate', 263),
    ('bb_medical_services_old_mkb10record', 297),
    ('bb_sequences_sequence', 344),
    ('bb_appeals_appealpostponereason', 415),
    ('bb_medical_program_medicalprogrambestdoctorservicetype', 417),
    ('bb_approvals_autoapprovalwhitelist_services', 428),
    ('bb_attachment_lists_patientlistforclinic_clinics', 433),
    ('bb_insurance_fronter_provider', 448),
    ('bb_medical_program_bestdoctorservicetype_services', 450),
    ('bb_newsletters_chatnotifications_companies', 456),
    ('bb_symptomchecker_symptomchecker_factors', 479),
    ('bb_chat_buttonwidget', 488),
    ('bb_deposits_slotdepositinslot', 518),
    ('bb_prepaid_programs_prepaidprogramadvanceinvoice_holdings', 525),
    ('bb_appeals_appeallabel', 541),
    ('bb_chat_intercomtag_topics', 558),
    ('bb_programs_service_info_programinfoservicepgview', 627),
    ('bb_actual_visits_actualvisitdocument', 636),
    ('bb_patient_bills_franchisedebt', 683),
    ('bb_partners_subscriptionproduct', 699),
    ('bb_chunked_upload_chunkedfile', 727),
    ('bb_programs_insuranceriskinprogram', 730),
    ('bb_vzr_policy_rbiborderoslottorow', 750),
    ('bb_policy_change_history_programdatajsonfixevent', 756),
    ('bb_bestdoctor_stomatologypersonalfranchise', 94),
    ('bb_bestdoctor_polyclinicprogrammfranchise', 98),
    ('bb_bestdoctor_officedoctorpackage', 126),
    ('bb_bestdoctor_clinicmedtype', 144),
    ('bb_bestdoctor_bestdoctorservicetype', 164),
    ('bb_complaints_complaintcategory', 191),
    ('bb_redirects_redirect', 195),
    ('bb_patient_impressions_impression', 203),
    ('bb_django_celery_beat_intervalschedule', 216),
    ('bb_clinics_stomatology', 254),
    ('bb_content_templates_contenttemplatetype', 351),
    ('bb_programs_programstomatology', 405),
    ('bb_expertise_acts_approvalexpertise', 414),
    ('bb_approvals_approvementattachment', 421),
    ('bb_products_productprovider_clinics', 470),
    ('bb_symptomchecker_answer', 482),
    ('bb_clinics_clinicprepaidprogram', 499),
    ('bb_medical_program_serviceinprogramwithmergedconditionspgview', 533),
    ('bb_chat_tagrelation', 557),
    ('bb_request_letters_requestletter_service_tree_nodes', 570),
    ('bb_orders_retailmargin', 589),
    ('bb_employees_department', 613),
    ('bb_employees_workingshift', 616),
    ('bb_employees_employee', 617),
    ('bb_programs_program_languages', 639),
    ('bb_webask_webaskform', 658),
    ('bb_registries_productinorderregistryreason', 669),
    ('bb_sales_clinicforupsalepgview', 685),
    ('bb_dynamic_franchises_dynamicfranchisethresholdnotification', 690),
    ('bb_bestdoctor_stomatology', 84),
    ('bb_bestdoctor_personalfranchise', 99),
    ('bb_bestdoctor_reportrecord', 104),
    ('bb_analytics_companycostpermonthalert', 127),
    ('bb_bestdoctor_currency', 140),
    ('bb_myauth_softauthtoken', 150),
    ('bb_bestdoctor_clinictype', 180),
    ('bb_covid_bot_telegrampatient', 206),
    ('bb_covid_bot_telegrampatientchattodesktransport', 213),
    ('bb_chat_chattodesktagrelation_tags', 435),
    ('bb_medical_program_programtoclinictreelink', 295),
    ('bb_pricelists_medicalserviceinfo', 309),
    ('bb_voximplant_voximplantuser', 342),
    ('bb_franchises_medicaltypeprogramfranchise', 399),
    ('bb_slots_slot_program_options', 461),
    ('bb_telemedicine_consultation_checkups_expense_company', 474),
    ('bb_insurance_insurancerequestsetting', 509),
    ('bb_prepaid_programs_programprepaidprogram', 524),
    ('bb_chat_deeplink', 529),
    ('bb_camunda_performer_camundatask', 546),
    ('bb_partners_partnerprogramcertificateinvoice', 554),
    ('bb_products_productservice', 569),
    ('bb_promotions_audiencepromotion', 667),
    ('bb_medical_program_clinicprogram', 670),
    ('bb_dynamic_franchises_programfranchisethreshold', 678),
    ('bb_chat_chatphrase', 702),
    ('bb_supplementary_agreements_supplementaryagreementrequestdocument', 711),
    ('bb_registries_undigitizedprogramregistryreason', 719),
    ('bb_ses_bestinsure_sesdatatoappeal', 732),
    ('bb_vzr_policy_vzrprogrammatch', 744),
    ('bb_policy_change_history_personaldatajsonchangeevent', 753),
    ('bb_messaging_message', 9),
    ('bb_bestdoctor_medicalservice', 47),
    ('bb_integration_integrationuserauthinfo', 52),
    ('bb_bestdoctor_programm', 16),
    ('bb_bestdoctor_pricelistbyclinics', 129),
    ('bb_bestdoctor_newsletter', 139),
    ('bb_bestdoctor_complaintcategory', 163),
    ('bb_insurance_for_relatives_relativeinsurancerequest', 169),
    ('bb_hospitalization_hospitalizationevent', 181),
    ('bb_orders_orderbill', 396),
    ('bb_franchises_stomatologyprogramfranchise', 401),
    ('bb_programs_programpolyclinic', 407),
    ('bb_medical_program_medicalprogramservicetreenode', 420),
    ('bb_appeals_appeal_visits', 464),
    ('bb_products_product_clinics', 471),
    ('bb_products_product_service_types', 472),
    ('bb_symptomchecker_resultsettings', 484),
    ('bb_orders_productorder', 566),
    ('bb_orders_retailmarginservicetype', 590),
    ('bb_products_productinprogrampgview', 612),
    ('bb_staff_functionality', 623),
    ('bb_company_reports_serviceinslotoptionregistryreason', 642),
    ('bb_audiences_fileimportaudience', 650),
    ('bb_registry_requests_registryrequestclinic', 665),
    ('bb_integration_integratedvisit', 53),
    ('bb_bestdoctor_attachmentlisttoclinic', 42),
    ('bb_bestdoctor_commercialofferpackage', 56),
    ('bb_bestdoctor_ambulance', 57),
    ('bb_bestdoctor_clientregistry', 78),
    ('bb_bestdoctor_medicalservicepersonalfranchise', 95),
    ('bb_bestdoctor_patientbillgroup', 168),
    ('bb_approvals_approvementservicetreenode', 177),
    ('bb_covid_bot_telegramprogram', 207),
    ('bb_django_celery_beat_periodictask', 217),
    ('bb_actuarial_calculations_bonusservice', 228),
    ('bb_attachment_lists_clinicactionlog', 236),
    ('bb_franchises_medicalserviceprogrammfranchise', 269),
    ('bb_service_periods_additionalserviceforcompanyserviceperiod', 312),
    ('bb_slots_slotchangelog', 318),
    ('bb_expertise_acts_expertiseactcancellationreason', 333),
    ('bb_medical_program_clinicinprogramreadonlyview', 347),
    ('bb_companies_bestdoctorlegalentity', 394),
    ('bb_programs_programlaboratory', 408),
    ('bb_approvals_approvementservicecomplex_service_tree_nodes', 429),
    ('bb_attachment_lists_employeeattachmentlist_attached_patients', 431),
    ('bb_newsletters_newsletter_companies', 454),
    ('bb_visits_visit_alternative_clinics', 463),
    ('bb_symptomchecker_question', 481),
    ('bb_symptomchecker_button', 487),
    ('bb_partners_partnerprogram', 552),
    ('bb_products_productservice_clinics', 567),
    ('bb_claims_claimcategory', 573),
    ('bb_staff_workingshift', 624),
    ('bb_dialogues_emailmessage', 717),
    ('bb_companies_companyrole', 740),
    ('bb_bestdoctor_doctor', 15),
    ('bb_bestdoctor_stationardepartment', 118),
    ('bb_bestdoctor_programtoclinictreelink', 162),
    ('bb_patient_bills_patientbillrecord', 302),
    ('bb_patients_removepersonaldatarequest', 306),
    ('bb_chat_chattodesktag', 329),
    ('bb_clinics_clinicsupplementaryagreement', 436),
    ('bb_deposits_basedeposit', 516),
    ('bb_staff_department', 621),
    ('bb_registries_serviceinbaseprogramregistryreason', 651),
    ('bb_orders_partnerprogramcertificateorder', 654),
    ('bb_promotions_button', 673),
    ('bb_documents_approvementdocumentlink', 694),
    ('bb_comments_appealcommentlink', 707),
    ('bb_vzr_policy_borderoimport', 736),
    ('bb_newsletters_newsletterrecipient', 739),
    ('bb_products_productconfigurationitem', 748),
    ('bb_companies_companypermission', 749),
    ('bb_policy_change_history_patientdetachmentevent', 757),
    ('bb_easy_thumbnails_source', 19),
    ('bb_bestdoctor_brand', 40),
    ('bb_bestdoctor_reportfiles', 36),
    ('bb_bestdoctor_emaildistributiontemplate', 87),
    ('bb_bestdoctor_personalrecurrentbill', 107),
    ('bb_bestdoctor_scheduledslotprogramchange', 154),
    ('bb_appeals_instancechangerecordproxy', 199),
    ('bb_actuarial_calculations_vipdeposit', 231),
    ('bb_actuarial_calculations_totalcustomservice', 232),
    ('bb_actuarial_calculations_officedoctorpackage', 233),
    ('bb_company_action_logs_signeddocumentlog', 258),
    ('bb_products_product', 326),
    ('bb_medical_standards_medicalstandardservicetreenode', 423),
    ('bb_doctors_doctor_service_tree_nodes', 443),
    ('bb_email_distributions_emaildistributionplan_recipients', 444),
    ('bb_guarant_letters_guarantletter_service_tree_nodes', 446),
    ('bb_ratings_patientrating', 491),
    ('bb_medical_program_serviceinmedicalprogrampgview', 510),
    ('bb_insurance_insurancerequestsettingbypolicytype', 534),
    ('bb_clinics_clinicactualizationreason', 563),
    ('bb_products_productservice_medical_services_info', 568),
    ('bb_orders_programoptioninslotbycommonprogramorder', 618),
    ('bb_languages_language', 640),
    ('bb_company_reports_registryreason', 641),
    ('bb_sales_clinicinclinicgroup', 679),
    ('bb_comments_comment', 705),
    ('bb_vzr_policy_borderoimportsource', 735),
    ('bb_vzr_policy_rbiborderoimportrow', 738),
    ('bb_products_productconfiguration', 747),
    ('bb_orders_orderitemretailupsale', 751),
    ('bb_policy_change_history_patientprogramchangeevent', 761),
    ('bb_bestdoctor_comment', 18),
    ('bb_bestdoctor_principallegal', 79),
    ('bb_bestdoctor_polyclinicpersonalfranchise', 102),
    ('bb_bestdoctor_patientbankcard', 113),
    ('bb_looper_looperscheduledtaskdata', 121),
    ('bb_bestdoctor_lead', 124),
    ('bb_bestdoctor_complaint', 128),
    ('bb_bestdoctor_patientcreaterequest', 155),
    ('bb_covid_bot_telegramprogramservice', 209),
    ('bb_bestdoctor_removepersonaldatarequest', 214),
    ('bb_medical_program_programservicenode', 292),
    ('bb_company_reports_reportproposal', 353),
    ('bb_medical_program_clinicinprogrampgview', 359),
    ('bb_medical_program_medicalprogram', 416),
    ('bb_attachment_lists_employeeattachmentlist_events', 430),
    ('bb_clinics_clinicadvanceinvoice_holdings', 512),
    ('bb_appeals_appeal_appeal_labels', 542),
    ('bb_promotions_bannerstatistic', 609),
    ('bb_camunda_integration_ticketstep', 610),
    ('bb_doctors_doctor_languages', 637),
    ('bb_telemedicine_consultationtemplate_checkups_expense_company', 660),
    ('bb_orders_programoptioninslotbyclinicsupsaleorder', 689),
    ('bb_partners_partnerorder', 700),
    ('bb_dialogues_emailthread', 722),
    ('bb_registries_missedserviceregistryreason', 733),
    ('bb_registries_unmatchedserviceregistryreason', 734),
    ('bb_bestdoctor_companyactionlog', 35),
    ('bb_bestdoctor_emaildistributionitem', 86),
    ('bb_bestdoctor_metrostation', 91),
    ('bb_bestdoctor_medicalserviceproposal', 93),
    ('bb_bestdoctor_clinicbestdoctorservicetype', 175),
    ('bb_covid_bot_telegramuserstate', 212),
    ('bb_django_celery_beat_clockedschedule', 220),
    ('bb_newsletters_chatnotificationsmessages', 227),
    ('bb_orders_ordercancellationreason', 360),
    ('bb_insurance_insurancerequest', 412),
    ('bb_clinics_clinic_metro_stations', 438),
    ('bb_symptomchecker_symptomchecker', 480),
    ('bb_clinics_clinicadvanceinvoice', 513),
    ('bb_deposits_programdepositinprogram', 520),
    ('bb_notification_service_patientdevice', 555),
    ('bb_claims_feedback', 576),
    ('bb_products_productinprogram', 585),
    ('bb_medical_program_medicalprogramoption', 606),
    ('bb_promotions_banner', 607),
    ('bb_programs_programinsurancepremium', 630),
    ('bb_registries_productinslotoptionregistryreason', 645),
    ('bb_documents_visitdocumentlink', 695),
    ('bb_hr_calendarchange', 716),
    ('bb_integration_tele2orderrequest', 725),
    ('bb_bestdoctor_patientstuffstatus', 50),
    ('bb_waffle_sample', 152),
    ('bb_bestdoctor_clinicservicenode', 158),
    ('bb_bestdoctor_programservicenode', 160),
    ('bb_approvals_approvementservicetypenode', 178),
    ('bb_bestdoctor_programservicetreenode', 202),
    ('bb_clinics_clinicmedtype', 243),
    ('bb_clinics_cliniclicense', 248),
    ('bb_clinics_clinicanotherfile', 250),
    ('bb_franchises_stomatologyprogrammfranchise', 276),
    ('bb_geo_metroline', 278),
    ('bb_matching_medicalserviceproposal', 283),
    ('bb_medical_program_clinicservicetreenode', 289),
    ('bb_franchises_medicalserviceprogramfranchise', 398),
    ('bb_newsletters_chatnotificationsprogram', 402),
    ('bb_complaints_complaint_suspicious_records', 441),
    ('bb_programs_service_info_programserviceinfopgview', 504),
    ('bb_telemedicine_consultation_documents', 527),
    ('bb_chat_intercomtag', 559),
    ('bb_medical_program_medicalprograminprogramforproducts', 583),
    ('bb_sales_productforsale', 595),
    ('bb_sales_productforproductforsale', 597),
    ('bb_patients_patient_languages', 638),
    ('bb_service_levels_servicelevelprofile', 687),
    ('bb_vzr_policy_vzrproductconfigurationitem', 743),
    ('bb_bestdoctor_employee', 34),
    ('bb_bestdoctor_expertiseact', 80),
    ('bb_bestdoctor_relativeinsurancerequest', 109),
    ('bb_bestdoctor_accountuser', 142),
    ('bb_bestdoctor_additionalclinicmedtypeinfo', 143),
    ('bb_bestdoctor_additionalserviceforcompanyserviceperiod', 197),
    ('bb_promotions_promotion', 225),
    ('bb_company_reports_reportrecord', 260),
    ('bb_patients_patientemailverificationaction', 308),
    ('bb_visits_recommendationreaction', 322),
    ('bb_products_productprovider', 325),
    ('bb_products_programproduct', 341),
    ('bb_medical_program_programclinicalternative', 346),
    ('bb_medical_program_programalternativeclinic', 348),
    ('bb_registries_registryrecord_service_tree_node_categories', 465),
    ('bb_prepaid_programs_prepaidprogramregistry', 522),
    ('bb_medical_program_serviceinmedicalprogramwithprogramconditionspgview', 531),
    ('bb_mail_unsentemail', 560),
    ('bb_claims_complaint_appeals', 581),
    ('bb_orders_orderforpartnerprogramcertificate', 656),
    ('bb_dialogues_dialoguethread', 721),
    ('bb_chunked_upload_chunkedupload', 726),
    ('bb_vzr_policy_borderovzrpolicy', 741),
    ('bb_chat_message', 111),
    ('bb_bestdoctor_mkb10record', 123),
    ('bb_bestdoctor_expertiseactrecord', 141),
    ('bb_waffle_switch', 153),
    ('bb_django_celery_results_taskresult', 172),
    ('bb_bestdoctor_recommendationreaction', 173),
    ('bb_chat_chattodesktransport', 200),
    ('bb_programms_programm', 311),
    ('bb_pricelists_medicalserviceinfomedicalservice', 349),
    ('bb_mail_emailevent', 397),
    ('bb_vzr_policy_vzrprovider', 537),
    ('bb_claims_claimresult', 577),
    ('bb_pricelists_actualmedicalserviceinfo', 605),
    ('bb_pricelists_medicalserviceinfo_service_types', 619),
    ('bb_medical_program_commonclinicservicetreenode', 629),
    ('bb_registry_requests_registryrequest', 666),
    ('bb_patient_bills_franchisedebtnotification', 684),
    ('bb_chat_chatphrasecase', 703),
    ('bb_metrics_holdingmetricset', 713),
    ('bb_vzr_policy_rbiborderoslotaggregation', 745),
    ('bb_bestdoctor_commercialoffer', 55),
    ('bb_bestdoctor_patientbillrecord', 114),
    ('bb_bestdoctor_cliniccomplaint', 133),
    ('bb_bestdoctor_personalbillrefundlog', 134),
    ('bb_bestdoctor_frontingagreement', 147),
    ('bb_chat_telegramuser', 165),
    ('bb_bestdoctor_approvementservicetypenode', 179),
    ('bb_exoskeleton_overriddenisgpforprogramclinic', 187),
    ('bb_bestdoctor_companyadditionalservice', 196),
    ('bb_franchises_personalfranchise', 272),
    ('bb_medical_program_servicetreenode', 294),
    ('bb_supplementary_agreements_frontingagreement', 320),
    ('bb_promotions_promotioncode', 338),
    ('bb_franchises_polyclinicprogramfranchise', 400),
    ('bb_chat_chatkeywordcase_ignore_patients_with_tags', 550),
    ('bb_chat_tag', 556),
    ('bb_claims_complaint', 582),
    ('bb_programs_programoptioninprogram', 586),
    ('bb_registries_registryreason', 643),
    ('bb_registries_productincompanyoptionregistryreason', 653),
    ('bb_patient_bills_franchisedebt_patient_bills', 682),
    ('bb_sales_clinicgroupupsaletermpgview', 686),
    ('bb_vzr_policy_vzrpartnerprogram', 742),
)



important_tables_list = [
    ('bb_supplementary_agreements_supplementaryagreement', 335), ('bb_registries_registry', 190),
    ('bb_patients_patient', 305), ('bb_medical_program_clinicinprogram', 287), ('bb_pricelists_pricelist', 310),
    ('bb_telemedicine_consultation', 343), ('bb_clinics_clinic', 241), ('bb_clinics_clinicnetwork', 244),
    ('bb_company_reports_reportfiles', 259), ('bb_expertise_acts_expertiseact', 266), ('bb_companies_holding', 255),
    ('bb_registries_registryrecordmedicalservice', 350), ('bb_supplementary_agreements_payment', 339),
    ('bb_service_periods_companyservicecontract', 631), ('bb_registries_registryrecord', 189)
]


class DwsConn:
    def __init__(self, conn_string):
        self.conn_string = conn_string

    def select(self, query: str) -> List[tuple]:
        with psycopg2.connect(self.conn_string) as conn:
            with conn.cursor() as cursor:
                cursor.execute(query)
                return cursor.fetchall()

    def execute(self, query: str) -> None:
        with psycopg2.connect(self.conn_string) as conn:
            with conn.cursor() as cursor:
                cursor.execute(query)
                conn.commit()
def main():
    DWH = DwsConn(conn_string=gp_con)
    data_1 = DWH.select("select viewname,definition from pg_views where definition like '%bestdoctor_bb%' and schemaname not in ('bestdoctor_bb','big_brother','bestdoctor_bb_external_tables')")
    data_2 = DWH.select("select matviewname,definition from pg_matviews where definition like '%bestdoctor_bb%' and schemaname not in ('bestdoctor_bb','big_brother','bestdoctor_bb_external_tables')")

    tables_to_update=[]
    valuable_tables_list=[]

    for table in tables_list:
        for ddl in data_1:
            if table[0] in ddl[1]:
                if table[0] not in tables_to_update:
                    tables_to_update.append(table[0])
                    valuable_tables_list.append((table[0],table[1]))

    for table in tables_list:
        for ddl in data_2:
            if table[0] in ddl[1]:
                if table[0] not in tables_to_update:
                    tables_to_update.append(table[0])
                    valuable_tables_list.append((table[0], table[1]))

    final_list= [i for i in important_tables_list if i in valuable_tables_list ]
    for table in valuable_tables_list:
        if table not in final_list:
            final_list.append(table)
    print(final_list)
    if final_list==important_tables_list:
        print(True)
    else: raise ValueError("important_tables_list is not correct, check it")


main()